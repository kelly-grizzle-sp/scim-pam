swagger: '2.0'
info:
  title: PAM SCIM Extension
  description: |
    Privileged Account Management SCIM API extensions that promote integration with identity governance systems.
    
    The idea behind this API is to provide a common base for all PAM vendors to build on top of.  This API exposes the objects that are core to privileged account management, but can be extended by vendors that can provide additional information.  In the same way, some vendors may not support all of the endpoints or data that is described in this API.  When this is encountered, the PAM vendor can safely treat endpoints or data as optional.
    
    At a high-level, this API exposes the following concepts
    
     * User - A PAM user that is using the PAM system to manage or access privileged data.  This user can either exist only in the PAM system or can be an external user that is defined in another system (eg - Active Directory or LDAP).
     * Group - A group in the PAM system that can be used to govern access within the PAM system.  This group can either exist only in the PAM system or can be an external group that is defined in another system (eg - Active Directory or LDAP).
     * Container - A Container is a logical grouping of privileged data (credentials, etc...) that can be used for organizational or operational purposes.  Access control lists (ACLs) can be applied to a container to control which users and groups have permissions to the privileged data in the container.
     * Privileged Data - Privileged data is secret information that is protected by the PAM system (eg - a credential, an SSH key, etc...).  Privileged data MAY be stored inside of a Container, but does not have to be.  Access control lists (ACLs) can be applied to privileged data to control which users and groups have permissions to the privileged data.  More often, the ACL information is inherited from the container.
     * Access Control Lists (ACLs) - An access control list can be associated with a Container or Privileged Data.  This contains information about which users and groups have access to the Container/Data, and what rights they have.

  version: "1.0.0"
# the domain of the service
host: scim.example.com
# array of all schemes that your API supports
schemes:
  - https
# will be prefixed to all paths
basePath: /v2
produces:
  - application/scim+json
consumes:
  - application/scim+json

parameters:
  startIndex:
    name: startIndex
    in: query
    description: The 1-based index of the first query result
    required: false
    type: number
    format: integer
  count:
    name: count
    in: query
    description: The maximum number of results to return
    required: false
    type: number
    format: integer
  filter:
    name: filter
    in: query
    description: 'A SCIM filter string - see https://tools.ietf.org/html/rfc7644#section-3.4.2.2'
    required: false
    type: string

paths:
  /Users:
    get:
      summary: List or query users.
      description: |
        The Users endpoint returns information about users in the PAM system.  These may be local to the PAM system or be externally defined in another system (eg - in Active Directory or LDAP).
      parameters:
        - $ref: '#/parameters/startIndex'
        - $ref: '#/parameters/count'
        - $ref: '#/parameters/filter'
      tags:
        - Users
      responses:
        200:
          description: A ListResponse with the requested users.
          schema:
            $ref: '#/definitions/ListResponseOfUsers'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /Users/{userId}:
    get:
      summary: Retrieve a user.
      description: |
        This endpoint returns information about a requested user in the PAM system.  This user may be local to the PAM system or be externally defined in another system (eg - in Active Directory or LDAP).
      parameters:
        - name: userId
          in: path
          description: The ID of the user to retrieve
          required: true
          type: number
          format: integer
      tags:
        - Users
      responses:
        200:
          description: The requested User.
          schema:
            $ref: '#/definitions/User'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /Groups:
    get:
      summary: List or query groups.
      description: |
        The Groups endpoint returns information about groups in the PAM system.  These may be local to the PAM system or be externally defined in another system (eg - in Active Directory or LDAP).
      parameters:
        - $ref: '#/parameters/startIndex'
        - $ref: '#/parameters/count'
        - $ref: '#/parameters/filter'
      tags:
        - Groups
      responses:
        200:
          description: A ListResponse with the requested groups.
          schema:
            $ref: '#/definitions/ListResponseOfGroups'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /Groups/{groupId}:
    get:
      summary: Retrieve a group.
      description: |
        This endpoint returns information about a requested group in the PAM system.  This group may be local to the PAM system or be externally defined in another system (eg - in Active Directory or LDAP).
      parameters:
        - name: groupId
          in: path
          description: The ID of the group to retrieve
          required: true
          type: number
          format: integer
      tags:
        - Groups
      responses:
        200:
          description: The requested Group.
          schema:
            $ref: '#/definitions/Group'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /Containers:
    get:
      summary: List or query containers.
      description: |
        This endpoint returns information about the containers defined in the PAM system.  A Container is a logical grouping of privileged data (credentials, etc...) that can be used for organizational or operational purposes.  Access control list (ACL) information about which users and groups have permissions on a Container can be obtained through /ContainerPermissions.
      parameters:
        - $ref: '#/parameters/startIndex'
        - $ref: '#/parameters/count'
        - $ref: '#/parameters/filter'
      tags:
        - Containers
      responses:
        200:
          description: A ListResponse with the requested containers.
          schema:
            $ref: '#/definitions/ListResponseOfContainers'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /Container/{containerId}:
    get:
      summary: Retrieve a container.
      description: |
        This endpoint returns information about a requested Container.  A Container is a logical grouping of privileged data (credentials, etc...) that can be used for organizational or operational purposes.  Access control list (ACL) information about which users and groups have permissions on a Container can be obtained through /ContainerPermissions.
      parameters:
        - name: containerId
          in: path
          description: The ID of the container to retrieve
          required: true
          type: number
          format: integer
      tags:
        - Containers
      responses:
        200:
          description: The requested Container.
          schema:
            $ref: '#/definitions/Container'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /PrivilegedData:
    get:
      summary: List or query privileged data.
      description: |
        This endpoint returns information about the privileged data defined in the PAM system.  Privileged data is secret information that is protected by the PAM system (eg - a credential, an SSH key, etc...).  Privileged data MAY be stored inside of a Container, but does not have to be.  Access control list (ACL) information about which users and groups have permissions on a piece of PrivilegedData can be obtained through /PrivilegedDataPermissions.
      parameters:
        - $ref: '#/parameters/startIndex'
        - $ref: '#/parameters/count'
        - $ref: '#/parameters/filter'
      tags:
        - Privileged Data
      responses:
        200:
          description: A ListResponse with the requested privileged data.
          schema:
            $ref: '#/definitions/ListResponseOfPrivilegedData'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /PrivilegedData/{privilegedDataId}:
    get:
      summary: Retrieve a single PrivilegedData.
      description: |
        This endpoint returns information about a requested piece of PrivilegedData.  Privileged data is secret information that is protected by the PAM system (eg - a credential, an SSH key, etc...).  Privileged data MAY be stored inside of a Container, but does not have to be.  Access control list (ACL) information about which users and groups have permissions on a piece of PrivilegedData can be obtained through /PrivilegedDataPermissions.
      parameters:
        - name: privilegedDataId
          in: path
          description: The ID of the PrivilegedData to retrieve
          required: true
          type: number
          format: integer
      tags:
        - Privileged Data
      responses:
        200:
          description: The requested PrivilegedData.
          schema:
            $ref: '#/definitions/PrivilegedData'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /ContainerPermissions:
    get:
      summary: List or query container permissions.
      description: |
        This endpoint allows listing ACL information that is attached to containers.
      parameters:
        - $ref: '#/parameters/startIndex'
        - $ref: '#/parameters/count'
        - $ref: '#/parameters/filter'
      tags:
        - Access Control Lists
      responses:
        200:
          description: A ListResponse with the requested ContainerPermissions.
          schema:
            $ref: '#/definitions/ListResponseOfContainerPermissions'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /ContainerPermissions/{containerPermissionId}:
    get:
      summary: Retrieve a single ContainerPermission.
      description: |
        This endpoint allows retrieving ACL information that is attached to a container.
      parameters:
        - name: containerPermissionId
          in: path
          description: The ID of the ContainerPermission to retrieve
          required: true
          type: number
          format: integer
      tags:
        - Access Control Lists
      responses:
        200:
          description: The requested ContainerPermission.
          schema:
            $ref: '#/definitions/ContainerPermission'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /PrivilegedDataPermissions:
    get:
      summary: List or query privileged data permissions.
      description: |
        This endpoint allows listing ACL information that is attached to privileged data.
      parameters:
        - $ref: '#/parameters/startIndex'
        - $ref: '#/parameters/count'
        - $ref: '#/parameters/filter'
      tags:
        - Access Control Lists
      responses:
        200:
          description: A ListResponse with the requested PrivilegedDataPermissions.
          schema:
            $ref: '#/definitions/ListResponseOfPrivilegedDataPermissions'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

  /PrivilegedDataPermissions/{privilegedDataPermissionId}:
    get:
      summary: Retrieve a single ContainerPermission.
      description: |
        This endpoint allows retrieving ACL information that is attached to privileged data.
      parameters:
        - name: privilegedDataPermissionId
          in: path
          description: The ID of the PrivilegedDataPermission to retrieve
          required: true
          type: number
          format: integer
      tags:
        - Access Control Lists
      responses:
        200:
          description: The requested PrivilegedDataPermission.
          schema:
            $ref: '#/definitions/PrivilegedDataPermission'
        default:
          description: Unexpected error
          schema:
            $ref: '#/definitions/Error'

definitions:
  ListResponseOfUsers:
    type: object
    properties:
      totalResults:
        type: integer
        description: TODO
      startIndex:
        type: integer
        description: TODO
      itemsPerPage:
        type: integer
        description: TODO
      Resources:
        type: array
        items:
          $ref: '#/definitions/User'

  User:
    type: object
    properties:
      id:
        type: string
        description: TODO
      userName:
        type: string
        description: TODO
      'urn:ietf:params:scim:schemas:pam:1.0:LinkedObject':
        type: object
        properties:
          source:
            type: string
            description: The name of the external application on which this user lives.  If this is a PAM local user, this is null.
          nativeIdentifier:
            type: string
            description: The native identifier of the user on the external application (eg - the LDAP DN).  If this is a PAM local user, this is null.

  ListResponseOfGroups:
    type: object
    properties:
      totalResults:
        type: integer
        description: TODO
      startIndex:
        type: integer
        description: TODO
      itemsPerPage:
        type: integer
        description: TODO
      Resources:
        type: array
        items:
          $ref: '#/definitions/Group'

  Group:
    type: object
    properties:
      id:
        type: string
        description: TODO
      name:
        type: string
        description: TODO
      'urn:ietf:params:scim:schemas:pam:1.0:LinkedObject':
        type: object
        properties:
          source:
            type: string
            description: The name of the external application on which this group lives.  If this is a PAM local group, this is null.
          nativeIdentifier:
            type: string
            description: The native identifier of the group on the external application (eg - the LDAP DN).  If this is a PAM local group, this is null.

  ListResponseOfContainers:
    type: object
    properties:
      totalResults:
        type: integer
        description: TODO
      startIndex:
        type: integer
        description: TODO
      itemsPerPage:
        type: integer
        description: TODO
      Resources:
        type: array
        items:
          $ref: '#/definitions/Container'

  Container:
    type: object
    properties:
      id:
        type: string
        description: The unique identifier of the container.
      name:
        type: string
        description: The name of the container.
      displayName:
        type: string
        description: The display name of the container.  This is optional.  If null, the name will be used as the display name.
      description:
        type: string
        description: The description of the container.
      type:
        type: string
        description: The type of container (eg - management set or account store).  This is optional if the PAM system does not support multiple types of containers.
      owner:
        type: object
        description: The user that owns this container. TODO ... Can this be a group?  TODO ... can there be multiple??
        properties:
          value:
            type: string
            description: The ID of the user that owns this container
          '$ref':
            type: string
            description: A URI reference to the user that owns this container.
      privilegedData:
        type: array
        description: The privileged data that resides in this container.
        items:
          $ref: '#/definitions/PrivilegedDataReference'

  PrivilegedDataReference:
    type: object
    properties:
      value:
        type: string
        description: The ID of the privileged data.
      '$ref':
        type: string
        description: A URI reference to the PrivilegedData.

  ListResponseOfPrivilegedData:
    type: object
    properties:
      totalResults:
        type: integer
        description: TODO
      startIndex:
        type: integer
        description: TODO
      itemsPerPage:
        type: integer
        description: TODO
      Resources:
        type: array
        items:
          $ref: '#/definitions/PrivilegedData'

  PrivilegedData:
    type: object
    properties:
      id:
        type: string
        description: The unique identifier of the PrivilegedData.
      name:
        type: string
        description: A descriptive name for this piece of PrivilegedData.  For example, root@mylinuxhost
      description:
        type: string
        description: A description for this piece of PrivilegedData.
      type:
        type: string
        description: The type of PrivilegedData.  The value will be dependent on what is supported by the PAM system.  Examples include 'credential', 'ssh key', 'file', etc...

  ListResponseOfContainerPermissions:
    type: object
    properties:
      totalResults:
        type: integer
        description: TODO
      startIndex:
        type: integer
        description: TODO
      itemsPerPage:
        type: integer
        description: TODO
      Resources:
        type: array
        items:
          $ref: '#/definitions/ContainerPermission'

  ContainerPermission:
    properties:
      id:
        type: string
        description: The unique identifier of the ContainerPermission.
      container:
        type: object
        description: The container that these permissions apply to.  This is required.
        properties:
          value:
            type: string
            description: The ID of the container that these permissions apply to.
          '$ref':
            type: string
            description: A URI reference to the container that these permissions apply to.
      user:
        type: object
        description: The User that these permissions apply to.  Either this or group is required.
        properties:
          value:
            type: string
            description: The ID of the user that these permissions apply to.
          '$ref':
            type: string
            description: A URI reference to the user that these permissions apply to.
      group:
        type: object
        description: The Group that these permissions apply to.  Either this or user is required.
        properties:
          value:
            type: string
            description: The ID of the group that these permissions apply to.
          '$ref':
            type: string
            description: A URI reference to the group that these permissions apply to.
      rights:
        type: array
        description: The rights that the user or group has on this container.
        items:
          type: string

  ListResponseOfPrivilegedDataPermissions:
    type: object
    properties:
      totalResults:
        type: integer
        description: TODO
      startIndex:
        type: integer
        description: TODO
      itemsPerPage:
        type: integer
        description: TODO
      Resources:
        type: array
        items:
          $ref: '#/definitions/PrivilegedDataPermission'

  PrivilegedDataPermission:
    properties:
      id:
        type: string
        description: The unique identifier of the PrivilegedDataPermission.
      privilegedData:
        type: object
        description: The privileged data that these permissions apply to.  This is required.
        properties:
          value:
            type: string
            description: The ID of the PrivilegedData that these permissions apply to.
          '$ref':
            type: string
            description: A URI reference to the PrivilegedData that these permissions apply to.
      user:
        type: object
        description: The User that these permissions apply to.  Either this or group is required.
        properties:
          value:
            type: string
            description: The ID of the user that these permissions apply to.
          '$ref':
            type: string
            description: A URI reference to the user that these permissions apply to.
      group:
        type: object
        description: The Group that these permissions apply to.  Either this or user is required.
        properties:
          value:
            type: string
            description: The ID of the group that these permissions apply to.
          '$ref':
            type: string
            description: A URI reference to the group that these permissions apply to.
      rights:
        type: array
        description: The rights that the user or group has on this privileged data.
        items:
          type: string

  Error:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      fields:
        type: string
